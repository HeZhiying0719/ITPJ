<!DOCTYPE html>

{%load static%}

{% comment %} 
<html>
    <head>
        <title>users_management</title>
    <head>
    
    <body>
        <h1>Kiu says...</h1>
        <div>
            Here is the User Management page! <br/>
        </div>
    </body>
</html> {% endcomment %}

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>User Management - Focus Photography Forum</title>
        <!-- Bootstrap CSS -->
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"
            rel="stylesheet"
        />
        <!-- Font Awesome for icons -->
        <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
            rel="stylesheet"
        />
        <!-- Common CSS -->
        <link href="/static/css/common.css" rel="stylesheet" />
        <!-- Page Specific CSS -->
        <link href="/static/css/admin-users.css" rel="stylesheet" />
    </head>
    <body>
        <!-- Header/Navbar -->
        <nav
            class="navbar navbar-expand-lg navbar-light bg-white py-3 shadow-sm"
        >
            <div class="container">
                <!-- Logo -->
                <a class="navbar-brand" href="/index.html"
                    ><img src="/static/img/Logo1.png" alt="Focus Logo"
                /></a>

                <!-- Admin Icons -->
                <div class="d-flex align-items-center">
                    <div class="nav-item dropdown">
                        <a
                            href="#"
                            class="nav-link dropdown-toggle"
                            id="profileDropdown"
                            role="button"
                            data-bs-toggle="dropdown"
                            aria-expanded="false"
                        >
                            <img
                                src="/static/img/default-user.png"
                                alt="Profile"
                                class="avatar"
                            />
                        </a>
                        <ul
                            class="dropdown-menu dropdown-menu-end"
                            aria-labelledby="profileDropdown"
                        >
                            <li>
                                <a class="dropdown-item" href="/manager/posts/"
                                    >Posts Management</a
                                >
                            </li>
                            <li>
                                <a class="dropdown-item" href="/manager/users/"
                                    >Users Management</a
                                >
                            </li>
                            <li><hr class="dropdown-divider" /></li>
                            <li>
                                <form id="logout-form" action="{%url 'customer_logout'%}" method="post" style="display: none;">
                                    {% csrf_token %}
                                </form>
                                <a class="dropdown-item" href="#" onclick="document.getElementById('logout-form').submit();">Logout</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <div class="container py-4">
            <div class="row">
                <!-- Left Sidebar - Admin Menu -->
                <div class="col-md-3 category-nav">
                    <div class="list-group mb-4">
                        <a
                            href="/manager/posts/"
                            class="list-group-item list-group-item-action"
                            >Posts Management</a
                        >
                        <a
                            href="/manager/users/"
                            class="list-group-item list-group-item-action active"
                            >Users Management</a
                        >
                    </div>
                    <div class="mt-5">
                        <a
                            href="/manager/"
                            class="btn btn-outline-secondary w-100"
                            >About us</a
                        >
                    </div>
                </div>

                <!-- Right Content Area - Users Management -->
                <div class="col-md-9">
                    <div
                        class="d-flex justify-content-between align-items-center mb-4"
                    >
                        <h2 class="mb-0">User Management</h2>

                        <div>
                            <button
                                class="btn btn-primary"
                                data-bs-toggle="modal"
                                data-bs-target="#addUserModal"
                            >
                                <i class="fas fa-user-plus me-1"></i> Add User
                            </button>
                        </div>
                    </div>

                    <!-- Users List -->
                    <div class="users-list">
                        {%if users%}
                        <ul>
                            {%for user in users%}
                            <div class="card mb-3 user-item">
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        {% if user.user_profile.avatar %}
                                        <div class="col-md-1 text-center">
                                            <img
                                            src="{{user.user_profile.avatar.url}}"
                                            class="user-avatar rounded-circle"
                                            alt="User avatar"
                                            />
                                        </div>
                                        {% else %}
                                        <div class="col-md-1 text-center">
                                            <img
                                            src="\static\img\default-user.png"
                                            class="user-avatar rounded-circle"
                                            alt="User avatar"
                                            />
                                        </div>
                                        {% endif %}
                                        <div class="col-md-4">
                                            <h5 class="card-title mb-0">
                                                {{user.username}}
                                            </h5>
                                            <p
                                                class="card-text text-muted small mb-0"
                                            >
                                                {{user.email}}
                                            </p>
                                            {% if user.type == 'manager' %}
                                            <span
                                                class="badge bg-primary role-badge"
                                                >{{user.type}}</span
                                            >
                                            {% else %}
                                            <span
                                                class="badge bg-secondary role-badge"
                                                >{{user.type}}</span
                                            >
                                            {% endif %}
                                        </div>
                                        <div class="col-md-5">
                                            <div
                                                class="user-stats d-flex justify-content-around text-center"
                                            >
                                                <div class="stat-item">
                                                    <div class="stat-value">
                                                        {{user.date_joined}}
                                                    </div>
                                                    <div
                                                        class="stat-label small text-muted"
                                                    >
                                                        Joined
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div
                                            class="col-md-2 d-flex justify-content-end"
                                            >
                                            {% if user.type != 'manager' %}
                                            <a

                                                class="btn btn-outline-primary me-2 btn-sm action-btn"
                                                data-bs-toggle="tooltip"
                                                title="Make Admin"
                                                data-user-id="2"
                                                data-action="make-admin"
                                            >
                                                <i class="fas fa-user-shield"></i>
                                            </a>
                                            {% endif %}
                                            {% comment %} <button
                                                class="btn btn-outline-secondary me-2 btn-sm action-btn"
                                                data-bs-toggle="tooltip"
                                                title="Edit User"
                                                data-user-id="2"
                                                data-action="edit"
                                            >
                                                <i class="fas fa-user-edit"></i>
                                            </button> {% endcomment %}
                                            <button
                                                class="btn btn-outline-danger btn-sm action-btn"
                                                data-bs-toggle="tooltip"
                                                title="Delete User"
                                                data-user-id="2"
                                                data-action="delete"
                                            >
                                                <i class="fas fa-user-times"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        </ul>
                        {% else %}
                        <strong>Dear Manager. No users in the list.</strong>
                        {% endif %}
                    </div>
                    <!-- Pagination -->
                    <nav aria-label="Page navigation" class="mt-4">
                        <ul class="pagination justify-content-center">
                            {% if users.has_previous %}
                            <li class="page-item">
                                <a
                                    class="page-link"
                                    href="?page={{ users.previous_page_number }}"
                                    tabindex="-1"
                                    >Previous</a
                                >
                            </li>
                            {%else%}
                            <li class="page-item disabled">
                                <a class="page-link" href="#" tabindex="-1" aria-disabled="true">Previous</a>
                            </li>
                            {%endif%}
                            
                            {% for num in users.paginator.page_range %}
                            {% if users.number == num %}
                            <li class="page-item active">
                                <a class="page-link" href="#">{{ num }}</a>
                            </li>
                            {% else %}
                            <li class="page-item">
                                <a class="page-link" href="?page={{ num }}">{{ num }}</a>
                            </li>
                            {% endif %}
                            {% endfor %}
                
                            {% if users.has_next %}
                            <li class="page-item">
                                <a class="page-link" href="?page={{ users.next_page_number }}">Next</a>
                            </li>
                            {% else %}
                            <li class="page-item disabled">
                                <a class="page-link" href="#">Next</a>
                            </li>
                            {% endif %}
                        </ul>
                    </nav>
                </div>
            </div>
        </div>

        <!-- Edit User Modal -->
        <div
            class="modal fade"
            id="editUserModal"
            tabindex="-1"
            aria-labelledby="editUserModalLabel"
            aria-hidden="true"
        >
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="editUserModalLabel">
                            Edit User
                        </h5>
                        <button
                            type="button"
                            class="btn-close"
                            data-bs-dismiss="modal"
                            aria-label="Close"
                        ></button>
                    </div>
                    <div class="modal-body">
                        <form id="editUserForm">
                            <input type="hidden" id="editUserId" value="" />

                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="editFullName" class="form-label"
                                        >Full Name</label
                                    >
                                    <input
                                        type="text"
                                        class="form-control"
                                        id="editFullName"
                                        placeholder="Enter full name"
                                    />
                                </div>
                                <div class="col-md-6">
                                    <label for="editEmail" class="form-label"
                                        >Email</label
                                    >
                                    <input
                                        type="email"
                                        class="form-control"
                                        id="editEmail"
                                        placeholder="Enter email"
                                    />
                                </div>
                            </div>

                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="editUserRole" class="form-label"
                                        >User Role</label
                                    >
                                    <select
                                        class="form-select"
                                        id="editUserRole"
                                    >
                                        <option value="admin">
                                            Administrator
                                        </option>
                                        <option value="user">
                                            Regular User
                                        </option>
                                    </select>
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="editBio" class="form-label"
                                    >Biography</label
                                >
                                <textarea
                                    class="form-control"
                                    id="editBio"
                                    rows="3"
                                    placeholder="Enter user bio"
                                ></textarea>
                            </div>

                            <div class="mb-3">
                                <div class="form-check">
                                    <input
                                        class="form-check-input"
                                        type="checkbox"
                                        id="resetPassword"
                                    />
                                    <label
                                        class="form-check-label"
                                        for="resetPassword"
                                    >
                                        Reset Password
                                    </label>
                                </div>
                            </div>

                            <div class="mb-3 password-fields d-none">
                                <label for="newPassword" class="form-label"
                                    >New Password</label
                                >
                                <input
                                    type="password"
                                    class="form-control"
                                    id="newPassword"
                                    placeholder="Enter new password"
                                />
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button
                            type="button"
                            class="btn btn-secondary"
                            data-bs-dismiss="modal"
                        >
                            Cancel
                        </button>
                        <button
                            type="button"
                            class="btn btn-primary"
                            id="saveUserChanges"
                        >
                            Save Changes
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add User Modal -->
        <div
            class="modal fade"
            id="addUserModal"
            tabindex="-1"
            aria-labelledby="addUserModalLabel"
            aria-hidden="true"
        >
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="addUserModalLabel">
                            Add New User
                        </h5>
                        <button
                            type="button"
                            class="btn-close"
                            data-bs-dismiss="modal"
                            aria-label="Close"
                        ></button>
                    </div>
                    <div class="modal-body">
                        <form id="addUserForm">
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="fullName" class="form-label"
                                        >Full Name</label
                                    >
                                    <input
                                        type="text"
                                        class="form-control"
                                        id="fullName"
                                        placeholder="Enter full name"
                                        required
                                    />
                                </div>
                                <div class="col-md-6">
                                    <label for="email" class="form-label"
                                        >Email</label
                                    >
                                    <input
                                        type="email"
                                        class="form-control"
                                        id="email"
                                        placeholder="Enter email"
                                        required
                                    />
                                </div>
                            </div>

                            <div class="mb-3">
                                <label for="userRole" class="form-label"
                                    >User Role</label
                                >
                                <select class="form-select" id="userRole">
                                    <option value="admin">Administrator</option>
                                    <option value="user" selected>
                                        Regular User
                                    </option>
                                </select>
                            </div>

                            <div class="mb-3">
                                <label for="bio" class="form-label"
                                    >Biography</label
                                >
                                <textarea
                                    class="form-control"
                                    id="bio"
                                    rows="3"
                                    placeholder="Enter user bio"
                                ></textarea>
                            </div>

                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label for="password" class="form-label"
                                        >Password</label
                                    >
                                    <input
                                        type="password"
                                        class="form-control"
                                        id="password"
                                        placeholder="Enter password"
                                        required
                                    />
                                </div>
                                <div class="col-md-6">
                                    <label
                                        for="confirmPassword"
                                        class="form-label"
                                        >Confirm Password</label
                                    >
                                    <input
                                        type="password"
                                        class="form-control"
                                        id="confirmPassword"
                                        placeholder="Confirm password"
                                        required
                                    />
                                </div>
                            </div>

                            <div class="mb-3">
                                <div class="form-check">
                                    <input
                                        class="form-check-input"
                                        type="checkbox"
                                        id="sendWelcomeEmail"
                                        checked
                                    />
                                    <label
                                        class="form-check-label"
                                        for="sendWelcomeEmail"
                                    >
                                        Send welcome email
                                    </label>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button
                            type="button"
                            class="btn btn-secondary"
                            data-bs-dismiss="modal"
                        >
                            Cancel
                        </button>
                        <button
                            type="button"
                            class="btn btn-primary"
                            id="createUser"
                        >
                            Create User
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Delete User Confirmation Modal -->
        <div
            class="modal fade"
            id="deleteUserModal"
            tabindex="-1"
            aria-labelledby="deleteUserModalLabel"
            aria-hidden="true"
        >
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="deleteUserModalLabel">
                            Delete User
                        </h5>
                        <button
                            type="button"
                            class="btn-close"
                            data-bs-dismiss="modal"
                            aria-label="Close"
                        ></button>
                    </div>
                    <div class="modal-body">
                        <p>
                            Are you sure you want to delete this user? This
                            action cannot be undone.
                        </p>
                        <div class="alert alert-warning">
                            <i class="fas fa-exclamation-triangle me-2"></i> All
                            content created by this user will be permanently
                            removed.
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button
                            type="button"
                            class="btn btn-secondary"
                            data-bs-dismiss="modal"
                        >
                            Cancel
                        </button>
                        <button
                            type="button"
                            class="btn btn-danger"
                            id="confirmDeleteUser"
                        >
                            Delete User
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer text-center">
            <div class="container">
                <div class="row">
                    <div class="col-md-6">
                        <img src="/static/img/Logo2.png" alt="Logo" class="logo" />
                    </div>
                    <div class="col-md-6">
                        <h5>Connect With Us</h5>
                        <div class="d-flex justify-content-center">
                            <a href="#" class="text-white mx-2"
                                ><i class="fab fa-facebook-f"></i
                            ></a>
                            <a href="#" class="text-white mx-2"
                                ><i class="fab fa-twitter"></i
                            ></a>
                            <a href="#" class="text-white mx-2"
                                ><i class="fab fa-instagram"></i
                            ></a>
                            <a href="#" class="text-white mx-2"
                                ><i class="fab fa-youtube"></i
                            ></a>
                        </div>
                    </div>
                </div>
                <div class="mt-2">
                    <p class="small mb-0">
                        © 2025 Focus Photography Forum. All rights reserved.
                    </p>
                </div>
            </div>
        </footer>

        <!-- Bootstrap JS with Popper -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
        <!-- Custom JS -->
        <script src="/static/js/admin-users.js"></script>
    </body>
</html>
